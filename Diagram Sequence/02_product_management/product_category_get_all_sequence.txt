title Get All Product Categories Sequence Diagram

participant Client
participant ProductCategoryController
participant ProductCategoryService
participant ProductCategoryRepository
participant Database

Client->ProductCategoryController: 1. GET /api/ProductCategory?page={page}&pageSize={pageSize}
activate ProductCategoryController

note over ProductCategoryController: Requires Authorization

ProductCategoryController->ProductCategoryService: 2. Call GetAllProductCategoryAsync(page, pageSize, cancellationToken)
activate ProductCategoryService

ProductCategoryService->ProductCategoryRepository: 3. GetAllProductCategoryAsync(page, pageSize, cancellationToken)
activate ProductCategoryRepository

ProductCategoryRepository->ProductCategoryRepository: 4. NormalizePaging(page, pageSize)
ProductCategoryRepository->Database: 5. Query active categories with parent (Where IsActive=true)
activate Database
ProductCategoryRepository->Database: 6. COUNT total categories
Database-->ProductCategoryRepository: 7. Return total count
ProductCategoryRepository->Database: 8. SELECT categories (OrderBy CreatedAt DESC, Skip, Take)
Database-->ProductCategoryRepository: 9. Return category list
deactivate Database
ProductCategoryRepository-->ProductCategoryService: 10. Return (Items, Total)
deactivate ProductCategoryRepository

ProductCategoryService->ProductCategoryService: 11. Map Items to List<ProductCategoryResponseDTO>
ProductCategoryService->ProductCategoryService: 12. Create PagedResponse with pagination info
ProductCategoryService-->ProductCategoryController: 13. Return PagedResponse<ProductCategoryResponseDTO>
deactivate ProductCategoryService

ProductCategoryController->Client: 14. Return 200 OK (PagedResponse)
deactivate ProductCategoryController

note over Client,Database: Returns paginated list of active categories\nwith parent information included

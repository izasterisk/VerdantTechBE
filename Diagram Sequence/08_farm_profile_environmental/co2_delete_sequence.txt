title Delete Environmental Data Sequence Diagram

participant User
participant CO2UI
participant CO2Controller
participant CO2Service
participant EnvironmentalDataRepository
participant Database

User->CO2UI: 1. Delete environmental data (id)
CO2UI->CO2Controller: 2. DELETE /api/CO2/{id}
activate CO2Controller

note over CO2Controller: Requires Authorization

CO2Controller->CO2Service: 3. Call DeleteEnvironmentalDataByIdAsync(id)
activate CO2Service

CO2Service->EnvironmentalDataRepository: 4. DeleteEnvironmentalDataByIdWithTransactionAsync(id)
activate EnvironmentalDataRepository
EnvironmentalDataRepository->Database: 5. Check if environmental data exists
Database-->EnvironmentalDataRepository: 6. Return data existence status

alt Data Not Found
    EnvironmentalDataRepository-->CO2Service: 7.1 Return false
    CO2Service-->CO2Controller: 8.1 Return failure message
    CO2Controller->CO2UI: 9.1 Return 404 Not Found
    CO2UI->User: 10.1 Show error message
    deactivate EnvironmentalDataRepository
    deactivate CO2Service
    deactivate CO2Controller
else Data Found
    EnvironmentalDataRepository->Database: 7.2 Remove environmental data from database
    Database-->EnvironmentalDataRepository: 8.2 Return delete result
    EnvironmentalDataRepository-->CO2Service: 9.2 Return success (bool)
    deactivate EnvironmentalDataRepository
    CO2Service-->CO2Controller: 10.2 Return success message
    deactivate CO2Service
    CO2Controller->CO2UI: 11.2 Return 200 OK
    deactivate CO2Controller
    CO2UI->User: 12.2 Confirm deletion
end
